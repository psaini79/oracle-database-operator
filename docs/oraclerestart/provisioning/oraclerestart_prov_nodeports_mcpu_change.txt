$ kubectl apply -f oraclerestart_prov_nodeports.yaml

-- Before the memory and cpu change:
$ kubectl describe oraclerestarts.database.oracle.com/oraclerestart-sample -n orestart
Name:         oraclerestart-sample
Namespace:    orestart
Labels:       <none>
Annotations:  OracleRestarts.database.oracle.com/old-spec:
                {"instDetails":{"name":"dbmc1","hostSwLocation":"/scratch/orestart/","workerNode":["10.0.10.58"],"envVars":[{"name":"IGNORE_CRS_PREREQS","...
API Version:  database.oracle.com/v4
Kind:         OracleRestart
Metadata:
  Creation Timestamp:  2025-09-10T15:45:13Z
  Finalizers:
    database.oracle.com/oraclerestartfinalizer
  Generation:        1
  Resource Version:  234001859
  UID:               4b261940-9e2e-4ee0-8c21-75a57eb1b0ed
Spec:
  Asm Storage Details:
    Disks By Size:
      Disk Names:
        /dev/disk/by-partlabel/asm-disk1
        /dev/disk/by-partlabel/asm-disk2
      Storage Size In Gb:  50
  Config Params:
    Cpu Count:                   4
    Crs Asm Device List:         /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
    Crs Asm Disk Dg:             +DATA
    Crs Asm Disk Dg Redundancy:  external
    Db Base:                     /u01/app/oracle
    Db Char Set:                 AL32UTF8
    Db Data File Dest Dg:        +DATA
    Db Home:                     /u01/app/oracle/product/19c/dbhome_1
    Db Name:                     PORCLCDB
    Db Recovery File Dest:       +DATA
    Db Response File:
    Db Sw Zip File:  db_home.zip
    Grid Base:       /u01/app/grid
    Grid Home:       /u01/app/19c/grid
    Grid Response File:
    Grid Sw Zip File:        grid_home.zip
    Host Sw Stage Location:  /scratch/software/stage
    Inventory:               /u01/app/oraInventory
    Pga Size:                1G
    Processes:               2000
    Sga Size:                3G
    Sw Mount Location:       /u01
  Db Secret:
    Key File Mount Location:  /mnt/.dbsecrets
    Key File Name:            key.pem
    Name:                     db-user-pass-pkutl
    Pwd File Mount Location:  /mnt/.dbsecrets
    Pwd File Name:            pwdfile.enc
  Enable Ons:                 enable
  Image:                      localhost/oracle/database-orestart:19.3.0-slim
  Image Pull Policy:          IfNotPresent
  Inst Details:
    Env Vars:
      Name:            IGNORE_CRS_PREREQS
      Value:           true
      Name:            IGNORE_DB_PREREQS
      Value:           true
    Host Sw Location:  /scratch/orestart/
    Name:              dbmc1
    Worker Node:
      10.0.10.58
  Lb Service:
  Node Port Svc:
    Name:  dbmc1-service-nodeport
    Port Mappings:
      Node Port:    30007
      Port:         1521
      Protocol:     TCP
      Target Port:  1521
      Node Port:    30200
      Port:         6200
      Protocol:     TCP
      Target Port:  6200
    Svc Type:       nodeport
  Resources:
    Limits:
      Cpu:     2
      Memory:  16Gi
    Requests:
      Cpu:     2
      Memory:  16Gi
  Security Context:
    Sysctls:
      Name:   kernel.shmall
      Value:  2097152
      Name:   kernel.sem
      Value:  250 32000 100 128
      Name:   kernel.shmmax
      Value:  8589934592
      Name:   kernel.shmmni
      Value:  4096
  Service Details:
    Name:  soepdb
  Ssh Key Secret:
    Key Mount Location:    /mnt/.ssh
    Name:                  ssh-key-secret
    Priv Key Secret Name:  ssh-privkey
    Pub Key Secret Name:   ssh-pubkey
Status:
  Oracle Restart Nodes:
    Name:  dbmc1-0
    Node Details:
      Instance State:  OPEN
      Pod State:       AVAILABLE
      Cluster State:   HEALTHY
      Mounted Devices:
        /dev/disk/by-partlabel/asm-disk1
        /dev/disk/by-partlabel/asm-disk2
      State:  AVAILABLE
  Asm Details:
    Diskgroup:
      Disks:
        /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
      Name:        DATA
      Redundancy:  EXTERN
  Conditions:
    Last Transition Time:  2025-09-10T15:57:27Z
    Message:               reconcile has been queued
    Observed Generation:   1
    Reason:                LastReconcileCycleQueued
    Status:                True
    Type:                  ReconcileQueued
    Last Transition Time:  2025-09-10T20:38:23Z
    Message:               reconcile completed successfully
    Observed Generation:   1
    Reason:                LastReconcileCycleCompleted
    Status:                True
    Type:                  ReconcileComplete
  Config Params:
    Crs Asm Device List:         /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
    Crs Asm Disk Dg:             +DATA
    Crs Asm Disk Dg Redundancy:  external
    Db Base:                     /u01/app/oracle
    Db Data File Dest Dg:        +DATA
    Db Home:                     /u01/app/oracle/product/19c/dbhome_1
    Db Name:                     PORCLCDB
    Db Recovery File Dest:       +DATA
    Db Response File:
    Grid Base:  /u01/app/grid
    Grid Home:  /u01/app/19c/grid
    Grid Response File:
    Inventory:     /u01/app/oraInventory
  Connect String:  dbmc1-0:1521/PORCLCDB
  Db Secret:
    Key File Mount Location:  /mnt/.dbsecrets
    Key File Name:            key.pem
    Name:                     db-user-pass-pkutl
    Pwd File Mount Location:  /mnt/.dbsecrets
    Pwd File Name:            pwdfile.enc
  Db State:                   OPEN
  External Connect String:    Pending
  Pdb Connect String:         dbmc1-0:1521/ORCLPDB
  Release Update:             19.28.0.0.0
  Role:                       PRIMARY
  Service Details:
    Name:       soepdb
    Svc State:  service soepdb is running
  State:        AVAILABLE
Events:         <none>


[root@dbmc1-0 rac-work-dir]# cd /sys/fs/cgroup/memory
[root@dbmc1-0 memory]#  cat memory.limit_in_bytes
17179869184
[root@dbmc1-0 memory]#
[root@dbmc1-0 memory]# cd /sys/fs/cgroup/cpu/
[root@dbmc1-0 cpu]# cat cpu.cfs_quota_us
200000
[root@dbmc1-0 cpu]#





-- Attempt the memory and cpu change:
$ kubectl apply -f oraclerestart_prov_nodeports_mcpu_change.yaml

-- After the memory and cpu change:
-- The Oracle Restart Database Pod will be recreated:

$ kubectl get all -n orestart
NAME          READY   STATUS    RESTARTS   AGE   IP             NODE         NOMINATED NODE   READINESS GATES
pod/dbmc1-0   0/1     Running   0          13s   10.244.0.124   10.0.10.58   <none>           <none>

NAME                                     TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE    SELECTOR
service/dbmc1-0-local                    ClusterIP   None            <none>        <none>                          5h3m   statefulset.kubernetes.io/pod-name=dbmc1-0
service/dbmc1-service-nodeport-0-npsvc   NodePort    10.96.249.147   <none>        1521:30007/TCP,6200:30200/TCP   5h3m   statefulset.kubernetes.io/pod-name=dbmc1-0

NAME                     READY   AGE    CONTAINERS   IMAGES
statefulset.apps/dbmc1   0/1     5h3m   dbmc1        localhost/oracle/database-orestart:19.3.0-slim



-- After some time:
$ kubectl get all -n orestart
NAME          READY   STATUS    RESTARTS   AGE   IP             NODE         NOMINATED NODE   READINESS GATES
pod/dbmc1-0   1/1     Running   0           3m   10.244.0.124   10.0.10.58   <none>           <none>

NAME                                     TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE     SELECTOR
service/dbmc1-0-local                    ClusterIP   None            <none>        <none>                          5h17m   statefulset.kubernetes.io/pod-name=dbmc1-0
service/dbmc1-service-nodeport-0-npsvc   NodePort    10.96.249.147   <none>        1521:30007/TCP,6200:30200/TCP   5h17m   statefulset.kubernetes.io/pod-name=dbmc1-0

NAME                     READY   AGE     CONTAINERS   IMAGES
statefulset.apps/dbmc1   1/1     5h17m   dbmc1        localhost/oracle/database-orestart:19.3.0-slim



-- Memory and CPU changes will be reflected as below:

$ kubectl describe oraclerestarts.database.oracle.com/oraclerestart-sample -n orestart
Name:         oraclerestart-sample
Namespace:    orestart
Labels:       <none>
Annotations:  OracleRestarts.database.oracle.com/old-spec:
                {"instDetails":{"name":"dbmc1","hostSwLocation":"/scratch/orestart/","workerNode":["10.0.10.58"],"envVars":[{"name":"IGNORE_CRS_PREREQS","...
API Version:  database.oracle.com/v4
Kind:         OracleRestart
Metadata:
  Creation Timestamp:  2025-09-10T15:45:13Z
  Finalizers:
    database.oracle.com/oraclerestartfinalizer
  Generation:        2
  Resource Version:  234009515
  UID:               4b261940-9e2e-4ee0-8c21-75a57eb1b0ed
Spec:
  Asm Storage Details:
    Disks By Size:
      Disk Names:
        /dev/disk/by-partlabel/asm-disk1
        /dev/disk/by-partlabel/asm-disk2
      Storage Size In Gb:  50
  Config Params:
    Cpu Count:                   4
    Crs Asm Device List:         /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
    Crs Asm Disk Dg:             +DATA
    Crs Asm Disk Dg Redundancy:  external
    Db Base:                     /u01/app/oracle
    Db Char Set:                 AL32UTF8
    Db Data File Dest Dg:        +DATA
    Db Home:                     /u01/app/oracle/product/19c/dbhome_1
    Db Name:                     PORCLCDB
    Db Recovery File Dest:       +DATA
    Db Response File:
    Db Sw Zip File:  db_home.zip
    Grid Base:       /u01/app/grid
    Grid Home:       /u01/app/19c/grid
    Grid Response File:
    Grid Sw Zip File:        grid_home.zip
    Host Sw Stage Location:  /scratch/software/stage
    Inventory:               /u01/app/oraInventory
    Pga Size:                1G
    Processes:               2000
    Sga Size:                3G
    Sw Mount Location:       /u01
  Db Secret:
    Key File Mount Location:  /mnt/.dbsecrets
    Key File Name:            key.pem
    Name:                     db-user-pass-pkutl
    Pwd File Mount Location:  /mnt/.dbsecrets
    Pwd File Name:            pwdfile.enc
  Enable Ons:                 enable
  Image:                      localhost/oracle/database-orestart:19.3.0-slim
  Image Pull Policy:          IfNotPresent
  Inst Details:
    Env Vars:
      Name:            IGNORE_CRS_PREREQS
      Value:           true
      Name:            IGNORE_DB_PREREQS
      Value:           true
    Host Sw Location:  /scratch/orestart/
    Name:              dbmc1
    Worker Node:
      10.0.10.58
  Lb Service:
  Node Port Svc:
    Name:  dbmc1-service-nodeport
    Port Mappings:
      Node Port:    30007
      Port:         1521
      Protocol:     TCP
      Target Port:  1521
      Node Port:    30200
      Port:         6200
      Protocol:     TCP
      Target Port:  6200
    Svc Type:       nodeport
  Resources:
    Limits:
      Cpu:     4
      Memory:  20Gi
    Requests:
      Cpu:     4
      Memory:  20Gi
  Security Context:
    Sysctls:
      Name:   kernel.shmall
      Value:  2097152
      Name:   kernel.sem
      Value:  250 32000 100 128
      Name:   kernel.shmmax
      Value:  8589934592
      Name:   kernel.shmmni
      Value:  4096
  Service Details:
    Name:  soepdb
  Ssh Key Secret:
    Key Mount Location:    /mnt/.ssh
    Name:                  ssh-key-secret
    Priv Key Secret Name:  ssh-privkey
    Pub Key Secret Name:   ssh-pubkey
Status:
  Oracle Restart Nodes:
    Name:  dbmc1-0
    Node Details:
      Instance State:  OPEN
      Pod State:       AVAILABLE
      Cluster State:   HEALTHY
      Mounted Devices:
        /dev/disk/by-partlabel/asm-disk1
        /dev/disk/by-partlabel/asm-disk2
      State:  AVAILABLE
  Asm Details:
    Diskgroup:
      Disks:
        /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
      Name:        DATA
      Redundancy:  EXTERN
  Conditions:
    Last Transition Time:  2025-09-10T15:57:27Z
    Message:               reconcile has been queued
    Observed Generation:   1
    Reason:                LastReconcileCycleQueued
    Status:                True
    Type:                  ReconcileQueued
    Last Transition Time:  2025-09-10T21:03:50Z
    Message:               reconcile completed successfully
    Observed Generation:   2
    Reason:                LastReconcileCycleCompleted
    Status:                True
    Type:                  ReconcileComplete
  Config Params:
    Crs Asm Device List:         /dev/disk/by-partlabel/asm-disk1,/dev/disk/by-partlabel/asm-disk2
    Crs Asm Disk Dg:             +DATA
    Crs Asm Disk Dg Redundancy:  external
    Db Base:                     /u01/app/oracle
    Db Data File Dest Dg:        +DATA
    Db Home:                     /u01/app/oracle/product/19c/dbhome_1
    Db Name:                     PORCLCDB
    Db Recovery File Dest:       +DATA
    Db Response File:
    Grid Base:  /u01/app/grid
    Grid Home:  /u01/app/19c/grid
    Grid Response File:
    Inventory:     /u01/app/oraInventory
  Connect String:  dbmc1-0:1521/PORCLCDB
  Db Secret:
    Key File Mount Location:  /mnt/.dbsecrets
    Key File Name:            key.pem
    Name:                     db-user-pass-pkutl
    Pwd File Mount Location:  /mnt/.dbsecrets
    Pwd File Name:            pwdfile.enc
  Db State:                   OPEN
  External Connect String:    Pending
  Pdb Connect String:         dbmc1-0:1521/ORCLPDB
  Release Update:             19.28.0.0.0
  Role:                       PRIMARY
  Service Details:
    Name:       soepdb
    Svc State:  service soepdb is running
  State:        AVAILABLE
Events:         <none>




[root@dbmc1-0 rac-work-dir]# cd /sys/fs/cgroup/memory
[root@dbmc1-0 memory]# cat memory.limit_in_bytes
21474836480
[root@dbmc1-0 memory]#
[root@dbmc1-0 memory]# cd /sys/fs/cgroup/cpu/
[root@dbmc1-0 cpu]# cat cpu.cfs_quota_us
400000
[root@dbmc1-0 cpu]#