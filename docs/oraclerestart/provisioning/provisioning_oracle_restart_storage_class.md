# Provisioning an Oracle Restart Database with Custom Storage Class

In this use case, the Oracle Grid Infrastructure and Oracle Restart Database are deployed automatically using Oracle Restart Controller with Custom Storage Class. The responsefile is generated by the Oracle Restart Controller based on input parameters specified in the .yaml file.

This example uses `oraclerestart_prov_storage.yaml` to provision an Oracle Restart Database using Oracle Restart Controller with:

* 1 Node Oracle Restart
* Headless services for Oracle Restart
  * Oracle Restart node hostname
* Persistent volumes created automatically based on specified disks for Oracle Restart storage
* Software Persistent Volumes and Staged Software Persistent Volumes using the specified location on the corresponding worker nodes
* Namespace: `orestart`
* Staged Software location on the worker nodes is specified by `hostSwStageLocation` and we have copied the Grid Infrastructure and RDBMS Binaries to this location on the worker nodes
* Software location on the worker nodes is specified by `hostSwLocation`. The GI HOME and the RDBMS HOME in the Oracle Restart Pod will be mounted using this location on the worker node.
* Name of Custom Storage Class is specified by `storageClass`.


In this example, 
  * We are using Oracle Restart Database slim image by building it from Git location(./https://orahub.oci.oraclecorp.com/rac-docker-dev/rac-docker-images/-/blob/master/OracleRealApplicationClusters/README.md#building-oracle-rac-database-container-slim-image) i.e. `localhost/oracle/database-rac:19.3.0-slim`. To use this in your in own environment, update the image value in the `oraclerestart_prov_storage.yaml` file to point to your own container registry base container image.
  * The disks on the worker nodes for the Oracle Restart storage are `/dev/oracleoci/oraclevdd` and `/dev/oracleoci/oraclevde`. 
  * Specify the size of these devices along with names using the parameter `disksBySize`. Size is by-default in GBs.

  
Use the file: [oraclerestart_prov_storage.yaml](./oraclerestart_prov_storage.yaml) for this use case as below:

1. Deploy the `oraclerestart_prov_storage.yaml` file:
    ```sh
    kubectl apply -f oraclerestart_prov_storage.yaml
    oraclerestart.database.oracle.com/oraclerestart-sample created
    ```
2. Check the status of the deployment:
    ```sh
    # Check the status of the Kubernetes Pods:    
    kubectl get all -n orestart

    # Check the logs of a particular pod. For example, to check status of pod "dbmc1-0":    
    kubectl exec -it pod/dbmc1-0 -n orestart -- bash -c "tail -f /tmp/orod/oracle_rac_setup.log"
    ===============================
      ORACLE DATABASE IS READY TO USE
    ===============================
    ```
3. Check Details of Kubernetes CRD Object as in this [example](./orestart_storage_object.txt)
